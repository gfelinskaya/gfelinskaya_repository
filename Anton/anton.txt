Here is Anton's code THIRD BRANCH